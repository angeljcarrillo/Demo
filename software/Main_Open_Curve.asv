clear all
close all;
clc

a=[10,-180;10,-177;10,-174;10,-171;10,-168];%
b=[-376.073100000000,-346.850900000000;-374.739400000000,-341.687200000000;-374.877000000000,-336.355800000000;-376.160500000000,-331.237800000000;-375.969300000000,-326.078300000000];
c=[-376.290700000000,-311.007600000000;-372.638800000000,-307.520200000000;-370.753600000000,-302.835800000000;-371.979800000000,-298.524600000000;-373.532000000000,-293.067500000000;-376.477000000000,-288.965700000000;-380.637300000000,-286.104000000000;-383.582300000000,-282.002200000000;-384.963800000000,-277.145300000000;-383.290400000000,-272.987300000000;-381.172100000000,-267.723900000000;-377.811600000000,-263.955100000000;-373.373000000000,-261.547400000000];
d=[-338.327100000000,-389.884500000000;-343.421600000000,-389.539200000000;-348.990300000000,-388.805000000000;-354.354600000000,-387.575400000000;-358.332200000000,-384.652500000000;-360.984500000000,-380.422500000000;-361.258000000000,-375.664500000000;-358.637400000000,-372.098400000000;-354.328700000000,-369.932300000000;-349.849600000000,-370.666700000000;-344.732600000000,-372.360000000000;-343.413100000000,-369.595000000000;-344.490400000000,-365.302700000000;-347.403100000000,-361.247600000000;-351.465500000000,-358.061100000000;-356.227500000000,-355.788600000000;-361.385900000000,-354.434300000000;-366.483700000000,-354.727300000000;-368.629900000000,-358.069000000000;-366.636900000000,-361.036200000000;-364.282000000000,-359.454400000000];
e=[-358.028200000000,-340.264700000000;-360.917100000000,-335.781700000000;-362.914800000000,-330.836800000000;-360.888300000000,-327.355300000000;-357.580000000000,-323.028500000000;-357.611100000000,-318.546500000000;-360.131200000000,-314.635800000000;-364.323400000000,-312.368900000000;-362.772600000000,-310.340700000000;-359.326400000000,-305.833600000000;-359.069700000000,-301.245200000000;-360.512100000000,-296.406000000000;-358.679500000000,-292.440300000000];
f=[-330.943800000000,-387.790800000000;-332.189300000000,-382.488500000000;-331.535900000000,-377.081100000000;-329.154400000000,-372.693000000000;-325.060700000000,-371.338300000000;-319.786300000000,-369.407000000000;-320.387600000000,-366.345000000000;-323.955200000000,-365.207200000000;-328.511300000000,-362.545900000000;-329.309400000000,-358.481800000000;-328.696900000000,-353.412400000000;-328.016300000000,-347.779800000000;-328.214800000000,-342.393500000000;-328.597900000000,-336.789700000000];
g=[-353.819800000000,-288.687000000000;-353.819800000000,-283.013400000000;-353.819800000000,-277.339800000000;-353.996200000000,-271.725700000000;-354.348900000000,-266.119900000000;-355.209800000000,-260.684200000000;-357.408100000000,-256.012600000000;-361.302900000000,-253.365700000000;-366.208900000000,-251.423300000000;-371.348900000000,-250.937400000000;-376.997400000000,-250.403500000000;-376.815700000000,-247.515700000000;-373.518500000000,-246.669100000000;-368.565000000000,-247.294800000000;-363.312000000000,-246.798300000000;-359.112200000000,-244.314500000000;-357.762200000000,-240.159700000000;-357.093800000000,-234.868500000000;-357.093800000000,-229.421900000000];
h=[-337.609700000000,-333.136300000000;-341.581500000000,-329.577200000000;-344.816200000000,-325.336900000000;-346.850400000000,-320.529900000000;-347.797300000000,-315.339000000000;-347.923000000000,-309.950600000000;-346.743300000000,-304.865900000000;-343.088700000000,-303.040800000000;-340.932500000000,-305.526700000000;-338.428000000000,-310.170900000000;-335.607900000000,-315.028500000000;-331.872900000000,-318.593000000000;-327.339800000000,-319.348600000000;-324.508900000000,-316.563100000000;-324.860500000000,-312.493200000000;-326.307000000000,-307.359900000000;-328.148100000000,-302.113500000000;-330.315100000000,-296.993000000000;-332.799200000000,-292.018600000000;-335.590900000000,-287.210100000000;-338.562100000000,-282.443400000000;-341.681700000000,-277.772500000000];
i=[-325.675900000000,-268.555000000000;-331.236000000000,-268.555000000000;-336.785200000000,-268.205800000000;-342.135400000000,-267.185200000000;-345.807500000000,-264.147400000000;-345.807500000000,-260.062400000000;-342.725500000000,-259.574200000000;-337.603200000000,-260.221300000000;-332.156500000000,-260.221300000000;-326.607400000000,-259.872200000000;-320.993200000000,-259.695800000000;-315.533200000000,-259.006000000000;-310.913000000000,-256.831900000000;-309.325600000000,-252.822700000000;-311.735300000000,-252.441100000000;-316.857500000000,-253.088200000000;-322.449500000000,-253.616800000000;-327.952900000000,-253.616800000000;-333.626500000000,-253.616800000000;-339.240600000000,-253.440300000000;-344.445400000000,-252.276900000000;-349.570000000000,-250.431900000000;-348.609100000000,-247.762800000000;-344.817300000000,-246.789300000000;-339.451300000000,-246.282000000000;-333.802800000000,-245.748100000000;-329.116600000000,-243.720200000000;-329.971300000000,-240.778100000000;-332.850500000000,-241.421600000000;-338.127000000000,-241.421600000000;-343.530700000000,-240.739000000000;-346.560100000000,-237.513000000000;-344.529400000000,-236.634200000000;-339.346400000000,-235.645500000000;-333.773300000000,-234.582400000000;-328.386000000000,-234.413100000000;-323.292000000000,-235.551700000000;-317.755000000000,-236.789400000000;-312.424500000000,-236.956900000000;-307.835100000000,-235.139800000000;-304.344700000000,-231.649500000000;-304.849600000000,-227.653000000000;-308.227200000000,-226.898100000000;-313.444300000000,-227.062000000000;-319.050100000000,-227.414700000000;-324.712500000000,-227.770900000000;-330.374900000000,-228.127200000000;-335.810900000000,-227.785200000000;-341.161100000000,-226.764600000000;-346.341200000000,-225.081500000000;-350.472200000000,-222.080100000000;-354.600400000000,-218.440600000000];
% % ARQUIMIDES 360
% j=[-4.99671951015949,1.02117292208103;-5.02309242446947,1.34482061823778;-5.02828605986847,1.67521321035039;-5.01159263513040,2.01095481289530;-4.97239678109384,2.35058934128606;-4.91018018620798,2.69260664393643;-4.82452583492992,3.03544897306704;-4.71512181517936,3.37751776723967;-4.58176467284643,3.71718071697576;-4.42436229324747,4.05277908330691;-4.24293629142370,4.38263523772167;-4.03762389527079,4.70506039072172;-3.80867930766495,5.01836247508735;-3.55647453600392,5.32085414898357;-3.28149967989907,5.61086088321768;-2.98436267013002,5.88672909629231;-2.66578845439244,6.14683430038813;-2.32661762782611,6.38958922106021;-1.96780450879064,6.61345185324451;-1.59041466285161,6.81693341614737;-1.19562188043845,6.99860616973243;-0.784704616127074,7.15711105582615;-0.359041899973445,7.29116512733483;0.0798912662311787,7.39956872970175;0.530529012507772,7.48121239953041;0.991220186409906,7.53508344625682;1.46023440099332,7.56027218386717;1.93576852288851,7.55597778092247;2.41595357618849,7.52151369856508;2.89886203581339,7.45631268773781;3.38251548206270,7.35993131853866;3.86489258622467,7.23205401645657;4.34393739538869,7.07249658217971;4.81756788300864,6.88120917372839;5.28368473030065,6.65827873183361;5.74018030223525,6.40393083174939;6.18494778070681,6.11853094704357;6.61589041643988,5.80258511334897;7.03093086032655,5.45673998256356;7.42802053418710,5.08178226055532;7.80514900041080,4.67863752404333;8.16035328956941,4.24836841498164;8.49172714490447,3.79217221345400;8.79743014257259,3.31137779278585;9.07569664669326,2.80744196328273;9.32484455857949,2.28194521370049;9.54328382004478,1.73658686223050;9.72952463136789,1.17317963143141;9.88218534535852,0.593643664146502;10,0;10.0818254533456,-0.605636465442391;10.1266480857094,-1.22106451434698;10.1335900357177,-1.84400460628599;10.1019149384611,-2.47210731484220;10.0310331358189,-3.10296216994406;9.92050633098611,-3.73410687271595;9.77005166134170,-4.36303684773740;9.57954516601627,-4.98721509584802;9.34902462686568,-5.60408230901893;9.07869176400646,-6.21106720734539;8.76891376962076,-6.80559705690511;8.42022416637803,-7.38510832608050;8.03332297953874,-7.94705743696463;7.60907621459091,-8.48893156766780;7.14851463511264,-9.00825946071606;6.65283183844050,-9.50262219229158;6.12338162964430,-9.96966385680754;5.56167469725013,-10.4071021212424;4.96937459710447,-10.8127386037790;4.34829305372008,-11.1844690316067;3.70038459137730,-11.5202931332452;3.02774051015895,-11.8183242214428;2.33258222496336,-12.0767984235800;1.61725398835301,-12.2940835175769;0.884215020846286,-12.4686873325507;0.136031074934175,-12.5992656748976;-0.624634538309966,-12.6846297420757;-1.39503042867035,-12.7237529881354;-2.17232707854310,-12.7157774069786;-2.95362723101013,-12.6600192014165;-3.73597667610976,-12.5559738083338;-4.51637539519186,-12.4033202526463;-5.29178902140588,-12.2019248052481;-6.05916057268822,-11.9518439227753;-6.81542241209807,-11.6533264497598;-7.55750838900833,-11.3068150665901;-8.28236611349363,-10.9129469696344;-8.98696931528012,-10.4725537728967;-9.66833023783434,-9.98666062366085;-10.3235120175774,-9.45648452771612;-10.9496409978194,-8.88343188294208;-11.5439189268184,-8.26909522324197;-12.1036349893856,-7.61524917804538;-12.6261776216777,-6.92384565583654;-13.1090460592474,-6.19700826339053;-13.5498615690563,-5.43702597560581;-13.9463783169937,-4.64634607399070;-14.2964938234900,-3.82756637498444;-14.5982589610542,-2.98342677235439;-14.8498874490067,-2.11680012089801;-15.0497648023123,-1.23068249158007;-15.1964566932365,-0.328182831036659;-15.2887166865506,0.587487938930095;-15.3254933111870,1.51302834367467;-15.3059364335874,2.44505825922035;-15.2294029004896,3.38013125404312;-15.0954614215467,4.31474732407305;-14.9038966649659,5.24536597388759;-14.6547125422727,6.16841959527351;-14.3481346613464,7.08032709271763;-13.9846119300194,7.97750770396120;-13.5648172957769,8.85639496252245;-13.0896476104166,9.71345074806655;-12.5602226119281,10.5451793696841;-11.9778830193023,11.3481416265356;-11.3441877394834,12.1189687899324;-10.6609101891990,12.8543764507592;-9.93003373795493,13.5511781761984;-9.15374628202331,14.2062989199983;-8.33443396279190,14.8167881310310;-7.47467404635018,15.3798325056165;-6.57722698465812,15.8927683300388;-5.64502768205873,16.3530933608535;-4.68117599424276,16.7584781919757;-3.68892649003864,17.1067770591392;-2.67167750957106,17.3960380341287;-1.63295955539136,17.6245125632017;-0.576423056123100,17.7906643063257;0.494174455030370,17.8931772362539;1.57498170191004,17.9309629590451;2.66206751965071,17.9031672203781;3.75143515171804,17.8091755649287;4.83903693774221,17.6486181191380;5.92078933819487,17.4213734709040;6.99258824019013,17.1275716230631;8.05032448713181,16.7675960009742;9.08989957358447,16.3420844980727;10.1072414456220,15.8519295469006;11.0983203460094,15.2982772068411;12.0591646429101,14.6825252635638;12.9858765803791,14.0063203390171;13.8746478887154,13.2715540146648;14.7217751927961,12.4803579745443;15.5236751568124,11.6350981786044;16.2768993043636,10.7383680806539;16.9781484536499,9.79298090909129;17.6242867085264,8.80196103238697;18.2123549474454,7.76853443503080;18.7395837538116,6.69611833332425;19.2034057330073,5.58830996397852;19.6014671633027,4.44887458195501;19.9316389300412,3.28173270734613;20.1920266948853,2.09094666432249;20.3809802545016,0.880706458258065;20.4971020458600,-0.344684959929151;20.5392547582998,-1.58082699042587;20.5065680156742,-2.82323718779107;20.3984440952077,-4.06736751409132;20.2145626531749,-5.30862098297347;19.9548844311291,-6.54236863378094;19.6196539201524,-7.76396677307732;19.2094009644588,-8.96877441943152;18.7249412896417,-10.1521708860455;18.1673759449005,-11.3095734347787;17.5380896526952,-12.4364549343463;16.8387480634483,-13.5283614549478;16.0712939171171,-14.5809297313181;15.2379421176922,-15.5899044261940;14.3411737309122,-16.5511551264495;13.3837289197096,-17.4606930046814;12.3685988361028,-18.3146870798154;11.2990164924032,-19.1094800113556;10.1784466387035,-19.8416033632130;9.01057467763205,-20.5077922746164;7.79929465128808,-21.1049994774316;6.54869633909001,-21.6304086012814;5.26305150896924,-22.0814467101668;3.94679936789934,-22.4557960168316;2.60453126115567,-22.7514047238772;1.24097467294096,-22.9664969436159;-0.139023415930954,-23.0995816518357;-1.53051375473533,-23.1494606340313;-2.92846257270551,-23.1152353862180;-4.32776978841324,-22.9963129361752;-5.72328761279109,-22.7924105548595;-7.10983947795220,-22.5035593317536;-8.48223922223672,-22.1301065920783;-9.83531046044186,-21.6727171380684;-11.1639060669837,-21.1323733008757;-12.4629276988005,-20.5103737941187;-13.7273452841407,-19.8083313646046;-14.9522164029946,-19.0281692403137;-16.1327054848208,-18.1721163803238;-17.2641027494034,-17.2427015359555;-18.3418428171363,-16.2427461370135;-19.3615229157824,-15.1753560215777;-20.3189206117925,-14.0439120323246;-21.2100109955803,-12.8520595068402;-22.0309832517468,-11.6036966937805;-22.7782565471169,-10.3029621310439;-23.4484951715865,-8.95422102631409;-24.0386228691779,-7.56205068440014;-24.5458362993571,-6.13122502972787;-24.9676175715636,-4.66669827609921;-25.3017457990414,-3.17358779943012;-25.5463076214207,-1.65715627257769;-25.6997066490760,-0.122793124566303;-25.7606717860634,1.42400461049772;-25.7282643924074,2.97765198678105;-25.6018842506473,4.53249631179747;-25.3812743058543,6.08283771039308;-25.0665241527762,7.62295001284202;-24.6580722483384,9.14710189052928;-24.1567068324163,10.6495781612555;-23.5635655445721,12.1247011850460;-22.8801337293047,13.5668522704838;-22.1082414272781,14.9704930110263;-21.2500590549435,16.3301864705034;-20.3080917799530,17.6406181370439;-19.2851726047344,18.8966165650256;-18.1844541755656,20.0931736253075;-17.0093993394109,21.2254642849679;-15.7637704756555,22.2888658390428;-14.4516176346757,23.2789765183337;-13.0772655198898,24.1916333992209;-11.6452993545342,25.0229295435863;-10.1605496788781,25.7692302993910;-8.62807612791605,26.4271886951845;-7.05315024373678,26.9937598648146;-5.44123738074942,27.4662144418618;-3.79797776573143,27.8421508668244;-2.12916677823733,28.1195065538222;-0.440734520252399,28.2965678675464;1.26127525291706,28.3719788653590;2.97072676567236,28.3447487638137;4.68141434163981,28.2142580934160;6.38708492993536,27.9802635101565;8.08146095641397,27.6429012372066;9.75826341641404,27.2026891151569;11.4112351240888,26.6605272442756;13.0341640323059,26.0176972074575;14.6209065363071,25.2758598677982;16.1654106738515,24.4370517400469;17.6617391344257,23.5036799405433;19.1040919902893,22.4785157256115;20.4868290626443,21.3646866337420;21.8044918370599,20.1656672522281;23.0518248434653,18.8852686342079;24.2237964175167,17.5276263972823;25.3156187619748,16.0971875400131;26.3227672288636,14.5986960176264;27.2409987456342,13.0371771231488;28.0663693113079,11.4179207249513;28.7952504916236,9.74646341626788;29.4243448455416,8.02856963665698;29.9507002190635,6.27021182957886;30.3717228461930,4.47754970425073;30.6851892009755,2.65690867369145;30.8892565489020,0.814757544374070;30.9824721505311,-1.04231446385524;30.9637810749489,-2.90762128597137;30.8325325856435,-4.77440408378162;30.5884850664936,-6.63585573508790;30.2318094608428,-8.48514565127167;29.7630912020356,-10.3154448328373;29.1833306193045,-12.1199510710384;28.4939418085049,-13.8919142026410;27.6967499628692,-15.6246613241473;26.7939871646775,-17.3116218714220;25.7882866444944,-18.9463524706311];
% %PEANO 1
% k=[391.776900000000,-806.854000000000;373.095300000000,-806.854000000000;373.095300000000,-788.172400000000;391.776900000000,-788.172400000000;391.776900000000,-769.490900000000;373.095300000000,-769.490900000000];

curvas={a b c d e f g h i };
 %% available to be chosen 
% %% TODAS LAS CURVAS SE DISCRETRIZAN POR EL ESCC
% puntosT={};
% esccT={};
% for h=1:1:length(curvas)
%     ptD=curvas{:,h};
%     temp=ESCCF(ptD,1);
%     puntosT={puntosT{:,:} temp{1,2}};
%     esccT={esccT{:,:} temp{1,1}}; 
% end

%% TODAS LAS CURVAS SE DISCRETRIZAN POR EL SCC
puntosT={};
esccT={};
for h=1:1:length(curvas)
    ptD=curvas{:,h};
    temp=SCCF(ptD(:,2),ptD(:,1),1);
    esccT={esccT{:,:} temp{1,1}}; 
end


%% BUSCAR MAXIMO DE SEG
 seg=[];
 for i=1:1:length(puntosT)     
      seg=[seg(:,:) length(puntosT{:,i})];    
 end
L=lcms(seg);
S1=divisors(L);
n=max(seg);
[val,idx]=min(abs(S1-n));
minVal=S1(idx);

 S=minVal;
 %% NORMALIZAR SEG
 vec=puntosT;
for u=1:1:length(puntosT)
   vec{:,u}=optimazeCurve(S,puntosT{:,u}); %
end
%% CALCULO DISIMILITUD
alpha=.3;
J=dissimilarityF(vec,alpha,S,3); 
%% vector de curvas, alpha, segmentos para vizualisar, presicion de vista en decimales

xvalues = {'(a)','(b)','(c)','(d)','(e)','(f)','(g)','(h)','(i)'};
yvalues = {'(a)','(b)','(c)','(d)','(e)','(f)','(g)','(h)','(i)'};
h = heatmap(xvalues,yvalues,J);

h.Title = 'Dissimilarity';
h.XLabel = 'Chi Values';
h.YLabel = strcat('Alpha=',string(alpha));